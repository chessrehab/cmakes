 0a 3b 20 6e 61 73 6d 20 2d 66 20 65 6c 66 20 2d| )))nasm))f)elf))
 46 20 73 74 61 62 73 20 2d 67 20 70 72 6f 67 30| F)stabs))g)prog)
 31 2e 61 73 6d 0a 3b 20 6c 64 20 2d 6f 20 73 6e| ))asm)))ld))o)sn
 64 62 78 20 70 72 6f 67 30 31 2e 6f 20 3b 64 6f| dbx)prog)))o))do
 65 73 6e 74 20 77 6f 72 6b 20 6f 6e 20 36 34 62| esnt)work)on)))b
 69 74 20 61 72 63 68 69 74 65 63 74 75 72 65 2c| it)architecture)
 20 63 61 6e 20 62 65 20 75 73 65 64 20 66 6f 72| )can)be)used)for
 20 33 32 62 69 74 20 70 72 6f 63 65 73 73 6f 72| )))bit)processor
 0a 3b 20 6c 64 20 2d 6d 20 65 6c 66 5f 69 33 38| )))ld))m)elf_i))
 36 20 2d 73 20 2d 6f 20 73 6e 64 62 78 20 70 72| )))s))o)sndbx)pr
 6f 67 30 31 2e 6f 20 3b 77 6f 72 6b 73 20 6f 6e| og)))o))works)on
 20 36 34 62 69 74 20 61 72 63 68 69 74 65 63 74| )))bit)architect
 75 72 65 0a 3b 20 75 73 61 67 65 20 73 6e 64 62| ure)))usage)sndb
 78 20 3e 6f 75 74 70 75 74 66 69 6c 65 20 3c 69| x))outputfile))i
 6e 70 75 74 66 69 6c 65 0a 0a 0a 0a 73 65 63 74| nputfile))))sect
 69 6f 6e 20 2e 64 61 74 61 20 20 20 20 20 20 20| ion))data)))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 3b 69 6e 69 74 69 61 6c| )))))))))initial
 69 7a 65 64 20 67 6c 6f 62 61 6c 20 76 61 72 69| ized)global)vari
 61 62 6c 65 73 20 61 72 65 61 0a 20 20 20 20 6f| ables)area)))))o
 74 70 74 3a 20 64 62 20 22 20 30 30 20 30 30 20| tpt))db)))))))))
 30 30 20 30 30 20 30 30 20 30 30 20 30 30 20 30| ))))))))))))))))
 30 20 30 30 20 30 30 20 30 30 20 30 30 20 30 30| ))))))))))))))))
 20 30 30 20 30 30 20 30 30 22 2c 22 7c 20 78 78| ))))))))))))))xx
 78 78 78 78 78 78 78 78 78 78 78 78 78 78 22 2c| xxxxxxxxxxxxxx))
 20 31 30 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 3b 64 65 66 69 6e 69 74 69 6f 6e 20 6f 66 20| ))definition)of)
 61 20 73 74 72 69 6e 67 2c 20 77 69 74 68 20 70| a)string))with)p
 6f 69 6e 74 65 72 20 6f 74 70 74 20 70 6f 69 6e| ointer)otpt)poin
 74 69 6e 67 20 74 6f 20 66 69 72 73 74 20 62 79| ting)to)first)by
 74 65 20 77 68 65 72 65 20 74 68 65 20 6c 69 6e| te)where)the)lin
 65 20 6f 66 20 6f 75 74 70 75 74 20 77 69 6c 6c| e)of)output)will
 20 62 65 20 67 65 6e 72 61 74 65 64 0a 20 20 20| )be)genrated))))
 20 4c 45 4e 31 3a 20 65 71 75 20 24 2d 6f 74 70| )LEN)))equ)))otp
 74 0a 20 20 20 20 4f 46 46 53 20 65 71 75 20 35| t)))))OFFS)equ))
 30 0a 20 20 20 20 4f 54 50 54 5f 4c 45 4e 20 65| ))))))OTPT_LEN)e
 71 75 20 31 36 20 20 20 20 20 20 20 20 20 20 20| qu))))))))))))))
 20 20 20 20 20 20 3b 73 74 6f 72 69 6e 67 20 74| )))))))storing)t
 68 65 20 6c 65 6e 67 68 74 68 20 6f 66 20 74 68| he)lenghth)of)th
 65 20 6c 69 6e 65 20 69 6e 20 6d 75 62 65 72 20| e)line)in)muber)
 6f 66 20 64 69 67 69 74 73 0a 20 20 20 20 6c 6b| of)digits)))))lk
 70 20 64 62 20 22 30 31 32 33 34 35 36 37 38 39| p)db))))))))))))
 61 62 63 64 65 66 22 20 20 20 20 20 20 20 20 20| abcdef))))))))))
 20 20 20 20 20 20 3b 6c 6f 6f 6b 75 70 20 74 61| )))))))lookup)ta
 62 6c 65 20 66 6f 72 20 68 65 78 20 64 69 67 69| ble)for)hex)digi
 74 73 0a 20 20 20 20 0a 73 65 63 74 69 6f 6e 20| ts))))))section)
 2e 62 73 73 20 20 20 20 20 20 20 20 20 20 20 20| )bss))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 3b 75 6e 69 6e 69 74 69 61 6c 69 7a| )))))uninitializ
 65 64 20 67 6c 6f 62 61 6c 20 76 61 72 69 61 62| ed)global)variab
 6c 65 73 20 61 72 65 61 0a 20 20 20 20 62 75 66| les)area)))))buf
 66 20 72 65 73 62 20 31 36 20 20 20 20 20 20 20| f)resb))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 3b 65 6d 70 74 79 20 62 75| ))))))))empty)bu
 66 66 65 72 20 66 6f 72 20 72 65 61 64 69 6e 67| ffer)for)reading
 20 6e 75 6d 62 65 72 20 6f 66 20 63 68 61 72 73| )number)of)chars
 20 66 72 6f 6d 20 62 75 66 66 65 72 0a 0a 73 65| )from)buffer))se
 63 74 69 6f 6e 20 2e 74 65 78 74 20 20 20 20 20| ction))text)))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 3b 74 65 78 74 20| )))))))))))text)
 6f 66 20 63 6f 64 65 20 61 72 65 61 0a 20 20 20| of)code)area))))
 20 67 6c 6f 62 61 6c 20 5f 73 74 61 72 74 20 20| )global)_start))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 3b 65 6e 74 72 79 20| ))))))))))entry)
 70 6f 69 6e 74 20 64 65 66 69 6e 69 6e 67 20 6c| point)defining)l
 61 62 65 6c 20 65 6e 74 72 79 20 70 6f 69 6e 74| abel)entry)point
 20 6f 66 20 63 6f 64 65 0a 20 20 20 20 20 20 20| )of)code))))))))
 20 0a 5f 73 74 61 72 74 3a 20 20 20 20 20 20 20| ))_start))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3b 6c| )))))))))))))))l
 61 62 65 6c 20 65 6e 74 72 79 20 70 6f 69 6e 74| abel)entry)point
 0a 20 20 20 20 6e 6f 70 20 20 20 20 20 20 20 20| )))))nop))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 3b 6e 6f| ))))))))))))))no
 20 6f 70 65 72 61 74 69 6f 6e 2c 20 70 6f 69 6e| )operation))poin
 74 20 66 6f 72 20 64 65 62 75 67 67 65 72 20 74| t)for)debugger)t
 6f 20 73 74 6f 70 0a 0a 5f 72 65 61 64 5f 6f 70| o)stop))_read_op
 3a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 3b 6c 61 62 65 6c 20 65 6e 74 72 79| )))))label)entry
 20 70 6f 69 6e 74 20 66 6f 72 20 72 65 61 64 69| )point)for)readi
 6e 67 20 66 72 6f 6d 20 66 69 6c 65 20 6f 70 65| ng)from)file)ope
 72 61 74 69 6f 6e 0a 20 20 20 20 6d 6f 76 20 65| ration)))))mov)e
 61 78 2c 33 20 20 20 20 20 20 20 20 20 20 20 20| ax))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 3b 6d 6f 76 65 20 63 6f 64 65 20 66 6f| ))))move)code)fo
 72 20 69 6e 70 75 74 28 33 29 20 6c 69 6e 75 78| r)input))))linux
 20 61 70 69 20 73 79 73 74 65 6d 20 63 61 6c 6c| )api)system)call
 20 69 6e 74 6f 20 65 61 78 20 72 65 67 69 73 74| )into)eax)regist
 65 72 0a 20 20 20 20 6d 6f 76 20 65 62 78 2c 30| er)))))mov)ebx))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3b| ))))))))))))))))
 6d 6f 76 65 20 66 64 20 6e 75 6d 62 65 72 20 66| move)fd)number)f
 6f 72 20 73 74 64 69 6e 70 75 74 20 6f 70 65 72| or)stdinput)oper
 61 74 69 6f 6e 20 74 6f 20 65 61 78 20 72 65 67| ation)to)eax)reg
 69 73 74 65 72 0a 20 20 20 20 6d 6f 76 20 65 63| ister)))))mov)ec
 78 2c 62 75 66 66 20 20 20 20 20 20 20 20 20 20| x)buff))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 3b 6d 6f 76 65 20 61 20 70 6f 69 6e 74 65| )))move)a)pointe
 72 20 74 6f 20 66 69 72 73 74 20 63 68 61 72 20| r)to)first)char)
 62 79 74 65 20 6f 66 20 70 72 65 64 65 66 69 6e| byte)of)predefin
 65 64 20 75 6e 69 6e 69 74 69 61 6c 69 7a 65 64| ed)uninitialized
 20 62 75 66 66 65 72 0a 20 20 20 20 6d 6f 76 20| )buffer)))))mov)
 65 64 78 2c 4f 54 50 54 5f 4c 45 4e 20 20 20 20| edx)OTPT_LEN))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 3b 6e 75 6d 62 65 72 20| )))))))))number)
 6f 66 20 63 68 61 72 73 20 74 6f 20 62 65 20 72| of)chars)to)be)r
 65 61 64 20 73 74 6f 72 65 64 20 69 6e 20 65 64| ead)stored)in)ed
 78 20 72 65 67 69 73 74 65 72 0a 20 20 20 20 69| x)register)))))i
 6e 74 20 38 30 68 20 20 20 20 20 20 20 20 20 20| nt)))h))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 3b 63 61 6c 6c 20 6c 69 6e 75| )))))))call)linu
 78 20 73 79 73 74 65 6d 20 63 61 6c 6c 20 28 73| x)system)call))s
 6f 66 74 77 61 72 65 20 69 6e 74 65 72 72 75 70| oftware)interrup
 74 29 0a 20 20 20 20 0a 20 20 20 20 6d 6f 76 20| t)))))))))))mov)
 65 62 70 2c 65 61 78 0a 20 20 20 20 64 65 63 20| ebp)eax)))))dec)
 65 62 70 20 20 20 20 20 20 20 20 20 20 20 20 20| ebp)))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 3b 72 65 74 75 72 6e 20 76 61 6c 75 65 20 6f 66| )return)value)of
 20 72 65 61 64 20 73 79 73 63 61 6c 6c 20 69 73| )read)syscall)is
 20 73 74 6f 72 65 64 20 69 6e 20 65 61 78 2e 20| )stored)in)eax))
 77 65 20 64 75 70 6c 69 63 61 74 65 20 6f 74 20| we)duplicate)ot)
 74 6f 20 65 62 70 20 66 6f 72 20 6c 61 74 65 72| to)ebp)for)later
 0a 20 20 20 20 63 6d 70 20 65 61 78 2c 30 20 20| )))))cmp)eax))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 3b 74 65| ))))))))))))))te
 73 74 69 6e 67 20 69 66 20 72 65 74 75 72 6e 20| sting)if)return)
 76 61 6c 75 65 20 77 61 73 20 30 0a 20 20 20 20| value)was)))))))
 6a 65 20 5f 66 69 6e 69 73 68 20 20 20 20 20 20| je)_finish))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 3b 69 66 20 65 71 75 61| )))))))))if)equa
 6c 20 74 68 65 6e 20 72 65 61 64 69 6e 67 20 72| l)then)reading)r
 65 61 63 68 65 64 20 66 69 6c 65 20 65 6e 64 20| eached)file)end)
 61 6e 64 20 6a 75 6d 70 73 20 74 6f 20 6c 61 62| and)jumps)to)lab
 65 6c 20 5f 66 69 6e 69 73 68 0a 20 20 20 20 0a| el)_finish))))))
 20 20 20 20 78 6f 72 20 65 63 78 2c 65 63 78 20| ))))xor)ecx)ecx)
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 3b 77 69 70| )))))))))))))wip
 69 6e 67 20 6f 75 74 20 65 63 78 20 72 65 67 69| ing)out)ecx)regi
 73 74 65 72 0a 20 20 20 20 0a 5f 73 63 61 6e 5f| ster))))))_scan_
 6f 70 3a 20 20 20 20 20 20 20 20 20 20 20 20 20| op))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 3b 6c 61 62 6c 65 20 66 6f 72| )))))))lable)for
 20 65 6e 74 72 79 20 6f 66 20 62 75 66 66 65 72| )entry)of)buffer
 20 73 63 61 6e 6e 69 6e 67 20 6f 70 65 72 61 74| )scanning)operat
 69 6f 6e 0a 20 20 20 20 78 6f 72 20 65 61 78 2c| ion)))))xor)eax)
 65 61 78 0a 20 20 20 20 6d 6f 76 20 65 62 78 2c| eax)))))mov)ebx)
 65 63 78 20 20 20 20 20 20 20 20 20 20 20 20 20| ecx)))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 3b 63 6f 70 79 20 63 6f 75 6e 74 65 72 20 72 65| )copy)counter)re
 67 69 73 74 65 72 20 65 63 78 20 74 6f 20 65 62| gister)ecx)to)eb
 78 0a 20 20 20 20 73 68 6c 20 65 62 78 2c 31 20| x)))))shl)ebx)))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3b 6d| )))))))))))))))m
 75 6c 74 69 70 6c 79 20 65 62 78 20 62 79 20 32| ultiply)ebx)by))
 0a 20 20 20 20 61 64 64 20 65 62 78 2c 65 63 78| )))))add)ebx)ecx
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 3b 61 64| ))))))))))))))ad
 64 20 6f 6e 65 20 6d 6f 72 65 20 6d 75 6c 74 69| d)one)more)multi
 70 6c 69 63 61 74 69 6f 6e 20 74 6f 20 65 62 78| plication)to)ebx
 3d 20 6f 76 65 72 61 6c 6c 20 65 63 68 69 65 76| ))overall)echiev
 65 73 20 65 62 78 3d 65 63 78 20 2a 20 33 0a 20| es)ebx)ecx))))))
 20 20 20 0a 20 20 20 20 6d 6f 76 20 61 6c 2c 62| ))))))))mov)al)b
 79 74 65 20 5b 62 75 66 66 2b 65 63 78 5d 20 20| yte)[buff)ecx]))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 3b 63 6f 70 69 65 73 20 6f 6e 65 20 63 68 61| ))copies)one)cha
 72 20 66 72 6f 6d 20 72 65 61 64 20 62 75 66 66| r)from)read)buff
 65 72 20 74 6f 20 61 6c 20 72 65 67 69 73 74 65| er)to)al)registe
 72 0a 20 20 20 20 6d 6f 76 20 64 6c 2c 61 6c 20| r)))))mov)dl)al)
 20 0a 20 20 20 20 63 6d 70 20 61 6c 2c 36 34 0a| ))))))cmp)al))))
 20 20 20 20 6a 6e 61 20 5f 5f 6c 6f 77 0a 20 20| ))))jna)__low)))
 20 20 63 6d 70 20 61 6c 2c 31 32 32 0a 20 20 20| ))cmp)al))))))))
 20 6a 61 20 5f 5f 6c 6f 77 0a 20 20 20 20 6d 6f| )ja)__low)))))mo
 76 20 5b 6f 74 70 74 2b 65 63 78 2b 4f 46 46 53| v)[otpt)ecx)OFFS
 5d 2c 61 6c 0a 20 20 20 20 6a 6d 70 20 5f 5f 63| ])al)))))jmp)__c
 6e 74 0a 5f 5f 6c 6f 77 3a 0a 20 20 20 20 6d 6f| nt)__low))))))mo
 76 20 5b 6f 74 70 74 2b 65 63 78 2b 4f 46 46 53| v)[otpt)ecx)OFFS
 5d 2c 62 79 74 65 20 34 31 0a 20 20 20 20 6a 6d| ])byte))))))))jm
 70 20 5f 5f 63 6e 74 0a 0a 5f 5f 63 6e 74 3a 0a| p)__cnt))__cnt))
 0a 20 0a 20 20 20 20 61 6e 64 20 61 6c 2c 30 66| )))))))and)al))f
 68 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| h)))))))))))))))
 20 20 20 20 20 20 3b 6d 61 73 6b 73 20 6f 75 74| )))))))masks)out
 20 68 69 67 68 65 72 20 34 20 62 69 74 73 20 69| )higher)))bits)i
 6e 20 38 62 69 74 20 61 6c 20 72 65 67 69 73 74| n))bit)al)regist
 65 72 0a 20 20 20 20 6d 6f 76 20 61 6c 2c 5b 6c| er)))))mov)al)[l
 6b 70 2b 65 61 78 5d 20 20 20 20 20 20 20 20 20| kp)eax])))))))))
 20 20 20 20 20 20 20 20 20 20 3b 6d 61 6b 65 73| )))))))))))makes
 20 61 20 6c 6f 6f 6b 75 70 20 69 6e 20 6c 6b 70| )a)lookup)in)lkp
 20 74 6f 20 74 68 65 20 70 6f 73 69 74 69 6f 6e| )to)the)position
 20 6f 66 20 74 68 65 20 68 65 78 20 76 61 6c 75| )of)the)hex)valu
 65 20 61 6e 64 20 6d 6f 76 65 73 20 74 68 65 20| e)and)moves)the)
 64 69 67 69 74 20 62 79 74 65 20 74 6f 20 64 69| digit)byte)to)di
 0a 20 20 20 20 6d 6f 76 20 5b 6f 74 70 74 2b 65| )))))mov)[otpt)e
 62 78 2b 32 5d 2c 61 6c 20 20 20 20 20 20 20 20| bx))])al))))))))
 20 20 20 20 20 20 20 20 20 20 20 3b 6d 6f 76 65| ))))))))))))move
 20 74 68 65 20 68 65 78 20 63 68 61 72 20 74 6f| )the)hex)char)to
 20 72 69 67 68 74 20 70 6c 61 63 65 20 69 6e 20| )right)place)in)
 66 69 6e 61 6c 20 72 6f 77 0a 20 20 20 20 0a 20| final)row)))))))
 20 20 20 73 68 72 20 64 6c 2c 34 20 20 20 20 20| )))shr)dl)))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 3b 6d 6f 76 65| ))))))))))))move
 73 20 34 20 68 69 67 68 65 72 20 62 69 74 73 20| s)))higher)bits)
 69 6e 20 64 6c 20 72 65 67 69 73 74 65 72 20 72| in)dl)register)r
 69 67 68 74 20 61 6e 64 20 77 69 70 65 73 20 6f| ight)and)wipes)o
 75 74 20 6c 6f 77 65 72 20 34 20 62 69 74 73 0a| ut)lower)))bits)
 20 20 20 20 6d 6f 76 20 64 6c 2c 5b 6c 6b 70 2b| ))))mov)dl)[lkp)
 65 64 78 5d 20 20 20 20 20 20 20 20 20 20 20 20| edx]))))))))))))
 20 20 20 20 20 20 20 3b 6d 61 6b 65 73 20 61 20| ))))))))makes)a)
 6c 6f 6f 6b 75 70 20 69 6e 20 6c 6b 70 20 74 6f| lookup)in)lkp)to
 20 74 68 65 20 70 6f 73 69 74 69 6f 6e 20 6f 66| )the)position)of
 20 74 68 65 20 68 65 78 20 76 61 6c 75 65 20 61| )the)hex)value)a
 6e 64 20 6d 6f 76 65 73 20 74 68 65 20 64 69 67| nd)moves)the)dig
 69 74 20 62 79 74 65 20 74 6f 20 64 69 0a 20 20| it)byte)to)di)))
 20 20 6d 6f 76 20 5b 6f 74 70 74 2b 65 62 78 2b| ))mov)[otpt)ebx)
 31 5d 2c 64 6c 20 20 20 20 20 20 20 20 20 20 20| )])dl)))))))))))
 20 20 20 20 20 20 20 20 3b 0a 20 20 20 20 0a 20| ))))))))))))))))
 20 20 20 69 6e 63 20 65 63 78 0a 20 20 20 20 63| )))inc)ecx)))))c
 6d 70 20 65 63 78 2c 65 62 70 20 20 20 20 20 20| mp)ecx)ebp))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 3b 63 6f 6d 70 61 72 65 73 20 63 6f 75| ))))compares)cou
 6e 74 65 72 20 69 6e 20 65 63 78 20 77 68 65 74| nter)in)ecx)whet
 68 65 72 20 69 74 20 72 65 61 63 68 65 64 20 74| her)it)reached)t
 68 65 20 65 6e 64 20 6f 66 20 73 63 61 6e 6e 65| he)end)of)scanne
 64 20 62 75 66 66 65 72 0a 20 20 20 20 6a 6e 61| d)buffer)))))jna
 20 5f 73 63 61 6e 5f 6f 70 0a 20 20 20 20 0a 5f| )_scan_op))))))_
 77 72 69 74 65 5f 6f 70 3a 0a 20 20 20 20 6d 6f| write_op))))))mo
 76 20 65 61 78 2c 34 20 20 20 20 20 20 20 20 20| v)eax)))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 3b 73 65 74 20 75 70 20 65 61| )))))))set)up)ea
 78 20 72 65 67 69 73 74 65 72 20 74 6f 20 6e 75| x)register)to)nu
 6d 62 65 72 20 6f 66 20 6c 69 6e 75 78 20 61 70| mber)of)linux)ap
 69 20 77 72 69 74 65 20 73 79 73 74 65 6d 20 63| i)write)system)c
 61 6c 6c 0a 20 20 20 20 6d 6f 76 20 65 62 78 2c| all)))))mov)ebx)
 31 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 3b 73 65 74 20 75 70 20 65 62 78 20 72 65 67 69| )set)up)ebx)regi
 73 74 65 72 20 74 6f 20 6e 75 6d 62 65 72 20 6f| ster)to)number)o
 66 20 6f 75 74 70 75 74 20 66 69 6c 65 20 64 65| f)output)file)de
 73 63 72 69 70 74 6f 72 0a 20 20 20 20 6d 6f 76| scriptor)))))mov
 20 65 63 78 2c 6f 74 70 74 20 20 20 20 20 20 20| )ecx)otpt)))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 3b| ))))))))))))))))
 73 65 74 20 74 68 65 20 65 63 78 20 72 65 67 69| set)the)ecx)regi
 73 74 65 72 20 74 6f 20 70 6f 69 6e 74 20 74 6f| ster)to)point)to
 20 66 69 72 74 73 20 62 79 74 65 20 6f 66 20 74| )firts)byte)of)t
 68 65 20 70 72 65 70 61 72 65 64 20 73 74 72 69| he)prepared)stri
 6e 67 0a 20 20 20 20 6d 6f 76 20 65 64 78 2c 4c| ng)))))mov)edx)L
 45 4e 31 20 20 20 20 20 20 20 20 20 20 20 20 20| EN))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 3b 73 65 74 20 74 68 65 20 65 64 78 20 72 65 67| )set)the)edx)reg
 69 73 74 65 72 20 74 6f 20 6e 75 6d 62 65 72 20| ister)to)number)
 6f 66 20 62 79 74 65 73 20 74 6f 20 62 65 20 77| of)bytes)to)be)w
 72 69 74 74 65 6e 0a 20 20 20 20 69 6e 74 20 38| ritten)))))int))
 30 68 20 20 20 20 20 20 20 20 20 20 20 20 20 20| )h))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 3b 65 78 65 63 75 74 65 20 77 72 69 74| ))))execute)writ
 65 20 73 79 73 74 65 6d 20 63 61 6c 6c 0a 0a 20| e)system)call)))
 20 20 20 6a 6d 70 20 5f 72 65 61 64 5f 6f 70 0a| )))jmp)_read_op)
 20 20 20 20 0a 0a 5f 66 69 6e 69 73 68 3a 0a 20| ))))))_finish)))
 20 20 20 6d 6f 76 20 65 61 78 2c 31 20 20 20 20| )))mov)eax))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 3b 6d 6f 76 65| ))))))))))))move
 20 63 6f 64 65 20 66 6f 72 20 65 78 69 74 28 31| )code)for)exit))
 29 20 6c 69 6e 75 78 20 73 79 73 74 65 6d 20 63| ))linux)system)c
 61 6c 6c 20 69 6e 74 6f 20 65 61 78 20 72 65 67| all)into)eax)reg
 69 73 74 65 72 0a 20 20 20 20 6d 6f 76 20 65 62| ister)))))mov)eb
 78 2c 30 20 20 20 20 20 20 20 20 20 20 20 20 20| x)))))))))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 3b 6d 6f 76 65 20 70 72 6f 67 72 61 6d 20| )))move)program)
 72 65 74 75 72 6e 20 76 61 6c 75 65 20 74 6f 20| return)value)to)
 72 65 67 69 73 74 65 72 20 65 62 78 0a 20 20 20| register)ebx))))
 20 69 6e 74 20 38 30 68 20 20 20 20 20 20 20 20| )int)))h))))))))
 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20| ))))))))))))))))
 20 20 20 20 20 20 20 20 20 3b 63 61 6c 6c 20 6c| ))))))))))call)l
 69 6e 75 78 20 61 70 69 20 73 79 73 74 65 6d 20| inux)api)system)
 63 61 6c 6c 28 73 6f 66 74 77 61 72 65 20 69 6e| call)software)in
 74 65 72 72 75 70 74 29 0a 20 20 20 20 0a 20 20| terrupt)))))))))
 20 20 6e 6f 70 0a 0a 20 0a 20 20 20 20 0a 20 20| ))nop)))))))))))
